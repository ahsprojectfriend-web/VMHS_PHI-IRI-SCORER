<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PHI-IRI Post Test | V. Mapa High School</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Comic+Neue:wght@400;700&display=swap');
        
        :root {
            --vmhs-blue: #1A47B8;
            --vmhs-gold: #FCD116;
            --vmhs-light: #f0f4ff;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }

        .comic-font { font-family: 'Comic Neue', cursive; }
        .bg-vmhs-blue { background-color: var(--vmhs-blue); }
        .text-vmhs-blue { color: var(--vmhs-blue); }
        .border-vmhs-blue { border-color: var(--vmhs-blue); }
        .bg-vmhs-gold { background-color: var(--vmhs-gold); }
        .border-vmhs-gold { border-color: var(--vmhs-gold); }

        .btn-primary {
            background-color: var(--vmhs-blue);
            color: white;
            transition: all 0.2s ease;
        }
        .btn-primary:hover:not(:disabled) {
            background-color: #0d2b7a;
            transform: translateY(-1px);
        }
        .btn-primary:disabled { opacity: 0.6; cursor: not-allowed; }

        .passage-box {
            background: white;
            border: 4px solid var(--vmhs-gold);
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.05);
            max-height: 400px;
            overflow-y: auto;
        }

        .option-card { border: 2px solid #e5e7eb; transition: all 0.2s ease; cursor: pointer; }
        .option-card:hover { border-color: var(--vmhs-blue); background-color: var(--vmhs-light); }
        .option-card.selected { border-color: #ef4444; background-color: #fee2e2; }

        /* Navigation Circle Styles */
        .nav-btn {
            width: 35px; height: 35px; border-radius: 50%; border: 2px solid #dadce0;
            background: white; font-weight: bold; display: flex; align-items: center;
            justify-content: center; transition: 0.2s; cursor: pointer;
        }
        .nav-btn.active { border-color: var(--vmhs-blue); background-color: var(--vmhs-light); color: var(--vmhs-blue); }
        .nav-btn.answered { background-color: #ef4444; border-color: #b91c1c; color: white; }

        /* Speaker Icon Styles */
        .speak-btn { 
            background: var(--vmhs-gold); border: none; border-radius: 50%; 
            width: 40px; height: 40px; cursor: pointer; margin-right: 15px; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 18px; flex-shrink: 0; box-shadow: 0 2px 5px rgba(0,0,0,0.2); 
        }
        .speak-btn:hover { transform: scale(1.1); background: #e6c200; }
        .flex-row-audio { display: flex; align-items: flex-start; margin-bottom: 15px; }
        .opt-row-audio { display: flex; align-items: center; width: 100%; margin-bottom: 8px; }

        .loader {
            border: 4px solid #f3f3f3; border-top: 4px solid var(--vmhs-blue);
            border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 md:p-8">

    <div class="w-full max-w-4xl bg-white rounded-3xl shadow-xl overflow-hidden mb-8">
        <div class="p-6 text-center border-b-4 border-vmhs-blue">
            <div class="flex flex-col items-center">
                <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4 overflow-hidden border-2 border-gray-200">
                    <img src="VMHS_LOGO.jpg" alt="VMHS Logo" onerror="this.innerHTML='LOGO'; this.classList.add('p-4','text-xs','text-gray-400')" class="object-contain w-full h-full">
                </div>
                <h1 class="text-2xl md:text-3xl font-bold text-vmhs-blue uppercase tracking-tight">V. Mapa High School</h1>
                <div class="mt-2 bg-vmhs-gold px-6 py-1 rounded-full text-sm font-bold uppercase tracking-widest shadow-sm">
                    PHI-IRI Post Test
                </div>
            </div>
        </div>

        <div class="p-6 md:p-10">
            <div id="setup-page" class="space-y-6">
                <div class="flex items-center gap-2 mb-4">
                    <div class="w-2 h-8 bg-vmhs-blue rounded-full"></div>
                    <h2 class="text-xl font-bold text-gray-800 uppercase">Student Information</h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-1"><label class="text-xs font-bold text-gray-500 uppercase">LRN No.</label><input type="text" id="lrn" maxlength="12" class="w-full p-3 border rounded-xl outline-none" placeholder="12-digit LRN"></div>
                    <div class="space-y-1"><label class="text-xs font-bold text-gray-500 uppercase">Surname</label><input type="text" id="surname" class="w-full p-3 border rounded-xl outline-none"></div>
                    <div class="space-y-1"><label class="text-xs font-bold text-gray-500 uppercase">First Name</label><input type="text" id="firstName" class="w-full p-3 border rounded-xl outline-none"></div>
                    <div class="space-y-1"><label class="text-xs font-bold text-gray-500 uppercase">M.I.</label><input type="text" id="mi" maxlength="2" class="w-full p-3 border rounded-xl outline-none"></div>
                    <div class="space-y-1">
                        <label class="text-xs font-bold text-gray-500 uppercase">Grade Level</label>
                        <select id="studentGrade" class="w-full p-3 border rounded-xl bg-white outline-none">
                            <option value="7">Grade 7</option><option value="8">Grade 8</option><option value="9">Grade 9</option><option value="10">Grade 10</option>
                        </select>
                    </div>
                    <div class="space-y-1"><label class="text-xs font-bold text-gray-500 uppercase">Section</label><input type="text" id="section" class="w-full p-3 border rounded-xl outline-none"></div>
                </div>
                <button class="btn-primary w-full py-4 rounded-2xl font-bold uppercase tracking-widest mt-4 shadow-lg" onclick="autoStartExam()">Start Assessment</button>
            </div>

            <div id="transition-step" class="hidden flex flex-col items-center justify-center py-12 space-y-6">
                <div class="loader"></div>
                <div class="text-center">
                    <h3 class="text-2xl font-bold text-vmhs-blue">Analyzing Performance...</h3>
                    <p id="transition-msg" class="text-gray-500 font-medium mt-2"></p>
                </div>
            </div>

            <div id="test-step" class="hidden space-y-6">
                <div id="question-nav" class="flex flex-wrap gap-2 justify-center mb-4"></div>
                <div class="flex justify-between items-center mb-2">
                    <span id="step-indicator" class="text-xs font-bold text-vmhs-blue uppercase tracking-widest bg-blue-50 px-3 py-1 rounded-full border border-blue-100"></span>
                    <span id="part-label" class="text-sm font-bold text-gray-600"></span>
                </div>
                <div id="passage-reference" class="passage-box comic-font p-6 rounded-2xl text-lg leading-relaxed whitespace-pre-wrap"></div>
                <div id="quiz-area" class="space-y-4"></div>
                
                <div class="flex gap-4 mt-6">
                    <button id="prev-btn" class="flex-1 py-4 rounded-xl font-bold bg-gray-200 text-gray-700" onclick="prevQuestion()">Previous</button>
                    <button id="next-btn" class="flex-1 py-4 rounded-xl font-bold btn-primary" onclick="handleNext()">Next Question</button>
                </div>
            </div>

            <div id="results-step" class="hidden">
                <div class="text-center mb-10"><h2 class="text-3xl font-bold text-vmhs-blue">Assessment Complete</h2></div>
                <div id="cumulative-results" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8"></div>
                <button id="db-btn" class="btn-primary w-full py-5 rounded-2xl font-bold uppercase tracking-widest shadow-lg" onclick="sendToDatabase()">Send to PHIL-IRI Database</button>
            </div>
        </div>
    </div>

<script>
    // Replace with your Google Apps Script URL if you deploy your own
    const FINAL_GS_LINK = "https://script.google.com/macros/s/AKfycbzz74XaT7TIhd7t91Z40oCiba-jFKBlbc_Gi7EiqxAXp4ki1FyAyogGExBV72jU9ImN/exec";

    const examData = {
        4: { title: "MARIAN'S EXPERIMENT", text: "Marian came home from school. She went to the kitchen and saw her mother cooking. 'Mama, do we have mongo seeds?' asked Marian. 'I will do an experiment.' \n\n'Yes, we have some in the cabinet,' answered Mama. \n\nMarian got some seeds and planted them in a wooden box. She watered the seeds every day. She made sure they got enough sun. After three days, Marian was happy to see stems and leaves sprouting. Her mongo seeds grew into young plants.", questions: [
            { q: "What did Marian look for in the kitchen?", options: ["a. mango seeds", "b. mongo seeds", "c. melon seeds"], correct: 1 },
            { q: "What did she do with the seeds?", options: ["a. She played with them.", "b. She cooked them.", "c. She planted them."], correct: 2 },
            { q: "Which of the following events happened last?", options: ["a. Some stems and leaves sprouted from the seeds.", "b. Marian planted the mongo seeds in a wooden box.", "c. Marian watered the soil where the seeds were planted"], correct: 0 },
            { q: "What did Marian know about planting seeds?", options: ["a. Seeds should be placed in a wooden box in the house.", "b. Seeds grow whether or not one takes care of them.", "c. Seeds need water and sunlight in order to grow"], correct: 2 },
            { q: "What can one learn from Marian?", options: ["a. It is good to be happy.", "b. It is good to be curious.", "c. It is good to be obedient"], correct: 1 },
            { q: "Which sentence tells that Marian's experiment was successful?", options: ["A. Mother said there were mongo seeds in the cabinet.", "B. Stems and leaves started to sprout from the seeds.", "C. The mongo seeds had enough water and sunlight."], correct: 1 }
        ] },
        5: { title: "TRADING PLACES", text: "On a trip to a university, the driver told the professor, 'I've heard you give this speech many times. I can deliver it for you.' \n\nThe professor said, 'The people in this university haven't seen me yet. Give the lecture. I'll pretend to be your driver.' \n\nWhen they arrived, the driver was introduced to be the professor. He gave an excellent speech. Everybody applauded. Afterwards, somebody asked a question which the driver couldn't answer. In order to get out of the sticky situation, he said, 'Oh, that's such an easy question. Even my driver can give you the answer!'", questions: [
            { q: "Why did the university invite the professor?", options: ["a. to give a test", "b. to give a lecture", "c. to donate books", "d. to attend classes"], correct: 1 },
            { q: "Why was it easy for the driver to pretend he was the professor?", options: ["a. The professor looked like the driver.", "b. The driver dressed up like the professor.", "c. The driver was as intelligent as the professor.", "d. The participants have not seen the professor yet."], correct: 3 },
            { q: "Why was the selection entitled Trading Places?", options: ["a. The driver could answer the question asked.", "b. The professor exchanged roles with the driver.", "c. The driver exchanged seats with the professor.", "d. The professor seated himself with the audience."], correct: 1 },
            { q: "Based on the selection, how would you describe the professor?", options: ["a. a boring lecturer", "b. an excellent driver", "c. a humorous person", "d. a generous employer"], correct: 2 },
            { q: "The diver tried to get out of a sticky situation. What was the sticky situation?", options: ["a. A participant recognized the professor.", "b. The driver could not deliver the lecture.", "c. The professor could not move from his seat.", "d. The driver did not know what to answer."], correct: 3 },
            { q: "Why did the driver say 'Even my driver can give you the answer!'?", options: ["a. to admit that even he did not know how to answer", "b. to stop the audience from asking more questions", "c. to stop the real professor from answering the question", "d. to prove to the participants that the question was easy"], correct: 1 },
            { q: "He gave a very good speech and everybody applauded. Another word for applauded is...", options: ["a. kept very quiet", "b. started to leave", "c. clapped their hands", "d. asked him to speak louder"], correct: 2 }
        ] },
        6: { title: "FLYING ROCKS", text: "There are rocks in our Solar System that never flocked together to form planets. Larger ones called asteroids gather in the Asteroid Belt, a strip found between Mars and Jupiter. Some asteroids don't move along this belt but have paths that bring them close to the earth. These are called Apollo Asteroids. \n\nThere may be half a million asteroids whose diameters are bigger than one kilometer. The largest asteroid is over 1000 kilometers across. It is speculated that many asteroids were once larger but they collided with each other and became small fragments. \n\nUnlike asteroids, meteoroids are small rocky bodies, that are scattered in space and do not orbit the sun. They cross the Earth's orbit and are often seen burning up in the Earth's atmosphere at night. The faint flashes of light they make are called shooting stars.", questions: [
            { q: "What are asteroids?", options: ["a. Large fragments of rock in the Solar System", "b. Large fragments of rock that circle the moon", "c. Small fragments of rock that do not circle the sun", "d. Small fragments of rock that do not circle the planets"], correct: 0 },
            { q: "What are meteoroids?", options: ["a. Large fragments of rock that circle the sun", "b. Large fragments of rock that circle the planets", "c. Small bits of rock that do not circle the sun", "d. Small bits of rock that do not cross the planets' orbits"], correct: 2 },
            { q: "Which among the following statements is NOT true?", options: ["a. Some asteroids move close to the earth.", "b. Large rocks flock together in the Asteroid Belt.", "c. All rocks in our Solar System have formed planets.", "d. The Asteroid Belt is found between Mars and Jupiter."], correct: 2 },
            { q: "â€œIt is speculated that many asteroids were once larger.â€ What does the word speculated mean?", options: ["a. written", "b. guessed", "c. confirmed", "d. questioned"], correct: 1 },
            { q: "What is a possible reason behind the fact that asteroids are not anymore as large as they were first thought to be?", options: ["a. They could have shrunk when they got closer to the sun", "b. They could have hit one another and broken into pieces.", "c. They could have burned up and eventually become smaller.", "d. They could have rammed into some planet and broken apart"], correct: 1 },
            { q: "Which of the following statements is TRUE of asteroids and meteoroids?", options: ["a. Both asteroids and meteoroids can be seen in a belt of rocks between Jupiter and Mars.", "b. Both asteroids and meteoroids circle the Earth and can be seen as faint flashes of light.", "c. Both asteroids and meteoroids are composed of rocky particles found in the Solar System.", "d. Both asteroids and meteoroids are scattered randomly across in space and do not orbit the sun"], correct: 2 },
            { q: "Many asteroids must have collided with one another. What is a synonym of the word 'collided'?", options: ["a. trapped into", "b. crashed into", "c. converged with", "d. connected with"], correct: 1 },
            { q: "If you see faint flashes of light in the night sky, which of the following could have happened?", options: ["a. Flames shoot up from the sun and come closer to the earth.", "b. Meteoroids have just crossed the earth's orbit and burned.", "c. Meteoroids have just crossed paths with the sun and burned.", "d. There are moments when the earth orbits a lot closer to the sun."], correct: 1 }
        ] },
        7: { title: "THE JEEPNEY: A FILIPINO TRADITION", text: "The jeepney is a popular means for people to travel in the Philippines. After World War II, Filipinos changed the old jeeps left by American soldiers into public vehicles. Today, these brightly colored jeepneys ply every street of the Philippines. Its design is a constant reminder of the Filipinosâ€™ creativity and resourcefulness.Not only that it is a sight to behold, these jeepneys have been so useful to the mass of Filipinos ever since its inception as a public vehicle. As proof, all throughout the Philippines, there are designated routes and numerous locations for passengers to board and disembark.Itâ€™s another thing to be inside the jeepneys. Passengers sit facing each other, making conversations more enjoyable. Hence, for many Filipinos, riding the jeepneys offers them time to socialize conveniently with one another, especially in cities where traffic is unbearable.However, the Filipinosâ€™ beloved jeepney is in danger of being off the road in the near future. According to the government, they want to make the jeepneys safer and better for the environment. They plan to replace old jeepneys with new ones that use electricity or less fuel. The drivers are worried because they might not have enough money to buy these new vehicles as they are more expensive than the old jeepneys.Even with this threat, the jeepney remains an important part of every Filipinoâ€™s life. Long after the Americans have left Philippine soil, its practicality and usefulness continue. People use jeepneys for varied reasons: to go around, visit friends and relatives, go to work, and see new places. It is hard to imagine how life can go on for an ordinary Filipino without the jeepneys. The plan to replace them should be thoughtfully considered.", questions: [
            { q: "Which of the following is implied in the first paragraph?", options: ["A. One of the things that Filipinos love to do is travelling.", "B. The American soldiers are very generous.", "C. The Filipino version of the jeepney is more creative.", "D. The jeepney is an original product of the Americans."], correct: 2 },
            { q: "What does â€œdisembarkâ€ mean in the sentence?", options: ["A. To book for a vehicle", "B. To get into a vehicle", "C. To get off a vehicle", "D. To wait for a vehicle"], correct: 2 },
            { q: "What can cause traffic to be unbearable?", options: ["A. When passengers are not facing each other", "B. When there is no one to talk to while travelling", "C. When there is no time to socialize", "D. When vehicles are either slow or not moving"], correct: 3 },
            { q: "According to the selection, why is the jeepney a popular vehicle among Filipinos?", options: ["A. Because they are brightly colored", "B. Because they are less expensive", "C. Because they can be found everywhere", "D. Because passengers can sit facing each other"], correct: 2 },
            { q: "What problem may arise from replacing jeepneys with vehicles that run on electricity?", options: ["A. Many drivers will not buy fuel anymore", "B. Many jeepney drivers will have no jobs", "C. More electricity will be consumed", "D. There will be fewer public vehicles"], correct: 1 },
            { q: "Why is the jeepney called a tradition?", options: ["A. Because people have been riding jeepneys for a very long time", "B. Because jeepneys show Filipinosâ€™ creativity and resourcefulness", "C. Because jeepneys can be seen all over the Philippines", "D. Because jeepneys have many uses for the people"], correct: 0 },
            { q: "What fact is presented in the selection?", options: ["A. Filipinos love to socialize while travelling around", "B. Many Filipinos use public utility vehicles like jeepneys", "C. Filipinos are very creative and resourceful", "D. The government cares for the safety of the environment"], correct: 1 },
            { q: "Which of the following is based on the authorâ€™s observation?", options: ["A. Filipinos changed the jeeps left by Americans after the war", "B. The government wants to make jeepneys safer and better", "C. The jeepney is a popular means of travel among Filipinos", "D. New vehicles are more expensive than jeepneys"], correct: 2 },
            { q: "What is the purpose of the last paragraph?", options: ["A. To convince people to disagree with the governmentâ€™s plan", "B. To emphasize the important role of jeepneys in Filipinosâ€™ lives", "C. To enumerate the reasons why jeepneys are useful", "D. To inform people about what happened to the jeeps left by Americans"], correct: 1 },
            { q: "Which of the following best summarizes the selection?", options: ["A. Americans gave Filipinos their jeeps for public use", "B. Filipinos love jeepneys because they are safe", "C. The government will phase out jeepneys because they are unsafe", "D. The jeepney, a popular vehicle in the Philippines, is in danger of being phased out"], correct: 3 }
        ] },
        8: { title: "THE IMPACT OF SOCIAL MEDIA ON COMMUNICATION", text: "Social media has changed the way we communicate with each other. It is like having a big town square where everyone can share news and stories instantly. Social media through the Internet has figuratively made the world smaller. All one needs is a gadget. It may be a smartphone, a tablet, or a laptop. Desktops can still be used. Through these devices, people can connect with friends and family members who may be on the far side of the globe.What is even more amazing is that we can make friends from practically everywhere on the planet. It is relatively easy to find common interests because we can easily make exchanges. We can choose to chat or make video calls using a platform of our choice. There is Messenger, Viber, and WhatsApp, to name a few. Chatting has gone a long way since Yahoo Messenger and Skype. And if we want people to be updated about us, there is Facebook, Instagram, and X (formerly known as Twitter).Personal communication is not the only one that has changed. Even businesses turn to social media and digital networks to promote and sell their products and to connect with prospective clients and business partners. The Internet becomes a convenient venue for posting business advertisements as it has a wider reach.But we are always warned about the dangers of communicating through the Internet. The information that we share becomes public and can be re-shared in either a positive or negative way. We have heard and read about people who become victims of malicious sharing of photos and videos.While we enjoy the ease and convenience of communicating through social media, we should also be aware of these threats. Otherwise, there is always the possibility that we will be part of the statistics of those whose lives are destroyed by oversharing.", questions: [
            { q: "Why does social media â€œrelatively make the world smallerâ€?", options: ["A. Family members can communicate anytime.", "B. People can use digital gadgets to communicate.", "C. One does not need to travel to meet people.", "D. We can share news and stories instantly."], correct: 2 },
            { q: "In the second paragraph, what does the word â€œexchangesâ€ mean?", options: ["A. conversations", "B. pictures", "C. products", "D. videos"], correct: 0 },
            { q: "What technique did the author use in communicating the message?", options: ["A. By describing a series of events", "B. By giving examples of platforms", "C. By narrating events in a random manner", "D. By using ordinary and familiar terms"], correct: 3 },
            { q: "Which of the following information is relevant to the discussion?", options: ["A. Being aware of privacy issues", "B. Choosing the right kind of social media", "C. Communicating using social media", "D. Knowing what to post in social media"], correct: 3 },
            { q: "Which of the following can be concluded about this article?", options: ["A. Every technological advancement has its advantages and disadvantages.", "B. Internet has become an important part of our lives.", "C. People would always discover ways of improving.", "D. The way we communicate today is far different."], correct: 0 },
            { q: "Which of the following is NOT discussed in the selection?", options: ["A. The convenience of using different platforms", "B. The importance of using digital gadgets", "C. The statistics of people victimized", "D. The types of communication that take place"], correct: 2 },
            { q: "What is the importance of the last paragraph?", options: ["A. It contains the topic sentence.", "B. It presents a summary of the article.", "C. It suggests an action to the issue.", "D. It supports the discussions in the article."], correct: 2 },
            { q: "Who will benefit from reading this article?", options: ["A. Advertisers", "B. People who like making friends", "C. People who love posting about activities", "D. People who use social media to talk to families"], correct: 2 },
            { q: "What is the general tone of this article?", options: ["A. Critical", "B. Didactic", "C. Scholarly", "D. Straightforward"], correct: 3 },
            { q: "What is the main purpose of the article?", options: ["A. To inform readers about increasing victims", "B. To persuade readers to be more careful", "C. To remind readers how social media influenced us", "D. To tell about ease and convenience"], correct: 1 }
        ] },
        9: { title: "THE RISE OF AI IN EDUCATION", text: "Artificial Intelligence or AI refers to technologies and systems that can accomplish tasks that typically require human intelligence, such as understanding language, recognizing patterns, and solving problems. AI has brought both major opportunities and notable challenges within the education framework.Personalized learning is AIâ€™s main benefit. Studentsâ€™ performances can be analyzed by an AI-based platform, which then determines their learning styles, strengths, and weaknesses and adjusts teaching strategies based on the evaluation. This is helpful when a student needs further preparation or additional lessons in subjects where they are struggling. This increases the effectiveness and inclusivity of education by enabling students to learn at their own pace. AI also saves teachers time by allowing them to automatically grade papers, manage calendars, and respond to basic student questionsâ€”tasks that would otherwise require a significant amount of their valuable time.There are also disadvantages in using AI in teaching. Student dependence on AI may cause delays in developing critical and creative thinking as well as problem-solving skills. If AI provides solutions too quickly, students may miss out on the learning process. Moreover, AI lacks human emotional intelligence. It gives instant feedback but cannot provide encouragement, empathy, or understanding in the same way that a human teacher can.It is common knowledge that AI has the ability to transform education through individualized instruction, adaptive assessments, and improved administrative efficiency. AI-powered technologies can assess large volumes of student data to customize learning paths and instructional materials, potentially increasing student engagement and academic performance. AI can also improve accessibility by offering real-time translation and accommodations for students with disabilities, thereby promoting inclusivity in learning environments around the world.Despite these advantages, the possible disadvantages and ethical concerns surrounding AI in education should not be ignored. Critics argue that excessive reliance on AI may reduce the value of human teachers, who play a vital role in facilitating face-to-face interactions essential for holistic education. Concerns such as data privacy, biased grading systems, and the digital divideâ€”where not all students have equal access to AI toolsâ€”must also be addressed.Despite the challenges brought by AI in education, there are exciting possibilities. AI can enhance engagement through interactive tools, personalized learning experiences, and valuable data to improve instruction. The challenge lies in integrating AI in a way that complements rather than replaces the essential human aspects of teaching. Ultimately, the key is finding a balance between technological innovation and preserving the critical role teachers play in student growth.", questions: [
            { q: "What is the meaning of the word â€œpersonalizationâ€?", options: ["A. AI provides information about individual learning.", "B. AI saves teachersâ€™ time.", "C. Students choose subjects they like.", "D. Students have more time to prepare."], correct: 0 },
            { q: "According to the selection, which teacher activity is facilitated by AI?", options: ["A. Developing curriculum", "B. Designing assessments", "C. Grading studentsâ€™ assignments", "D. Teaching difficult topics"], correct: 2 },
            { q: "How does AI influence the teaching process?", options: ["A. Instructional decision-making", "B. Repetitive role", "C. Replaces teacher", "D. Eliminates classroom teaching"], correct: 3 },
            { q: "Why would AI cause educational inequality?", options: ["A. Inaccessible to students with limited resources.", "B. Provides rural students richer resources.", "C. Increases workload.", "D. Too complicated to use."], correct: 0 },
            { q: "Which is true about AI?", options: ["A. Limitless possibilities for learning.", "B. Enhances thinking automatically.", "C. Completely replace teachers.", "D. Makes teaching unnecessary."], correct: 0 },
            { q: "Which needs further explanation?", options: ["A. How AI benefits learners with disabilities", "B. How AI delays critical thinking", "C. How AI helps save time", "D. How AI transforms process"], correct: 0 },
            { q: "What is the author suggesting in the last paragraph?", options: ["A. Use AI without limits", "B. Address the challenges brought by AI", "C. Rely fully on AI", "D. Balance AI use with the teacherâ€™s role"], correct: 3 },
            { q: "Which organizational technique is used?", options: ["A. Describing common knowledge", "B. Emphasizing data privacy", "C. Enumerating advantages/disadvantages", "D. Giving examples of platforms"], correct: 2 },
            { q: "What is the general tone?", options: ["A. Didactic", "B. Objective", "C. Urgent", "D. Serious"], correct: 1 },
            { q: "Which is NOT discussed?", options: ["A. Efficiency", "B. Promoting inclusivity", "C. Hinder face-to-face learning", "D. How AI benefits struggling students"], correct: 3 }
        ] },
        10: { title: "EXPLORING NON-MENDELIAN GENETICS", text: "Non-Mendelian genetics encompasses inheritance patterns that deviate from the traditional dominant and recessive allele framework established by Gregor Mendel through his experiments with pea plants. While Mendelian genetics laid the foundation for understanding heredity, many traits in living organisms exhibit more complex inheritance patterns. By exploring non-Mendelian concepts, we gain a deeper appreciation for the diversity of genetic traits present in nature.One significant form of non-Mendelian inheritance is incomplete dominance. In this pattern, the offspring display a phenotype that is a blend of traits from both parents. For example, crossing a red flower (RR) with a white flower (WW) results in pink offspring (RW). This shows that neither allele is completely dominant, leading to an intermediate expression of traits.Another non-Mendelian concept is codominance, which occurs when both alleles in a heterozygous individual are fully expressed. A well-known example can be seen in certain chicken breeds where black feathers (B) and white feathers (W) are codominant. When crossed, the offspring display both black and white feathers, demonstrating that both alleles contribute equally to the phenotype.Polygenic inheritance is another type of non-Mendelian inheritance in which multiple genes influence a single trait. Traits such as human height and skin color are controlled by several genes working together. This results in a wide range of phenotypes rather than distinct categories, illustrating the complexity of genetic inheritance beyond simple dominant-recessive relationships.Additionally, extranuclear inheritance involves genes located outside the nucleus, primarily in mitochondria or chloroplasts. Mitochondrial DNA is inherited from the mother and can result in traits or diseases that do not follow Mendelian patterns. This type of inheritance helps explain certain genetic conditions passed down through maternal lines.Understanding non-Mendelian genetics is essential in fields such as medicine, agriculture, and evolutionary biology. Recognizing that some genetic traits and disorders arise from multiple genes rather than a single gene improves approaches to treatment, prevention, and research. Overall, non-Mendelian genetics enriches our understanding of heredity and explains the complexity and diversity of life.", questions: [
            { q: "Diversity synonym?", options: ["A. concepts", "B. patterns", "C. types", "D. variety"], correct: 3 },
            { q: "Which is an example of codominance?", options: ["A. Black and white skin from both parents", "B. Blue eyes and curly hair from different parents", "C. Brown skin and tall height", "D. Diabetes from maternal line"], correct: 0 },
            { q: "Which is an example of incomplete dominance?", options: ["A. Black and white skin from both parents", "B. Blue eyes and curly hair from different parents", "C. Brown skin and tall height", "D. Diabetes from maternal line"], correct: 1 },
            { q: "Which is an example of extranuclear inheritance?", options: ["A. Black and white skin from both parents", "B. Blue eyes and curly hair from different parents", "C. Brown skin and tall height", "D. Diabetes from maternal line"], correct: 3 },
            { q: "Which of the following is an example of codominance?", options: ["A. Black and white skin from both parents", "B. Blue eyes and curly hair from different parents", "C. Brown skin and tall height", "D. Diabetes from maternal line"], correct: 0 },
            { q: "What is the importance of knowing non-Mendelian genetics?", options: ["A. Challenges Mendel", "B. Disproves Mendel", "C. Expands Mendel", "D. Improves Mendel"], correct: 2 },
            { q: "What is the purpose of the selection?", options: ["A. Argue against Mendel", "B. Describe different patterns", "C. Inform about limitations", "D. Persuade readers to adopt"], correct: 1 },
            { q: "Which is NOT discussed?", options: ["A. Complexities", "B. Descriptions of specific conditions", "C. Examples", "D. Significance"], correct: 1 },
            { q: "Which paragraph contains the topic sentence?", options: ["A. First paragraph", "B. Second paragraph", "C. Fourth paragraph", "D. Last paragraph"], correct: 0 },
            { q: "How did the author organize ideas?", options: ["A. Comparing", "B. Describing characteristics", "C. Cause-and-effect", "D. Problems"], correct: 1 }
        ] }
    };

    let sessionResults = [], queue = [], activeGrade, currentQIdx, currentScore, totalTestsInSequence = 1, finalPayload = {};
    let currentAnswers = [];
    let currentAudio = new Audio();

    function playFile(fileName) {
        currentAudio.pause();
        currentAudio = new Audio(fileName);
        currentAudio.play().catch(e => console.error("Could not find file: " + fileName));
    }

    function autoStartExam() {
        const lrn = document.getElementById('lrn').value.trim();
        const surname = document.getElementById('surname').value.trim();
        const first = document.getElementById('firstName').value.trim();
        if(lrn.length < 10 || !surname || !first) { 
            alert("Please complete student information correctly."); return; 
        }
        activeGrade = parseInt(document.getElementById('studentGrade').value);
        document.getElementById('setup-page').classList.add('hidden');
        runGradeSequence(activeGrade);
    }

    function runGradeSequence(level) {
        activeGrade = level; currentQIdx = 0; currentScore = 0;
        currentAnswers = new Array(examData[activeGrade].questions.length).fill(null);
        document.getElementById('transition-step').classList.add('hidden');
        document.getElementById('test-step').classList.remove('hidden');
        generateNav(); updateStepCounter(); loadQuestion();
    }

    function generateNav() {
        const nav = document.getElementById('question-nav');
        nav.innerHTML = examData[activeGrade].questions.map((_, i) => `<button id="nav-btn-${i}" class="nav-btn" onclick="jumpToQuestion(${i})">${i + 1}</button>`).join('');
    }

    function updateNavStyles() {
        examData[activeGrade].questions.forEach((_, i) => {
            const btn = document.getElementById(`nav-btn-${i}`);
            if(btn) {
                btn.classList.toggle('active', i === currentQIdx);
                btn.classList.toggle('answered', currentAnswers[i] !== null);
            }
        });
    }

    function loadQuestion() {
        const exam = examData[activeGrade]; const q = exam.questions[currentQIdx];
        const isAudioLevel = (activeGrade >= 4 && activeGrade <= 6);
        document.getElementById('part-label').innerText = `Assessment: Grade ${activeGrade}`;
        
        let passageHtml = isAudioLevel 
            ? `<div class="flex-row-audio">
                <button class="speak-btn" onclick="playFile('audio/GRADE${activeGrade}.mp3')">ðŸ”Š</button>
                <div style="flex:1;">${exam.text}</div>
               </div>`
            : `<div>${exam.text}</div>`;
        document.getElementById('passage-reference').innerHTML = passageHtml;

        let quizHtml = `
            <div class="space-y-4">
                <div class="p-6 bg-vmhs-light rounded-2xl border-2 border-vmhs-blue/10">
                    <div class="flex-row-audio">
                        ${isAudioLevel ? `<button class="speak-btn" onclick="playFile('audio/G${activeGrade}Q${currentQIdx + 1}Q.mp3')">ðŸ”Š</button>` : ''}
                        <div>
                            <p class="text-sm font-bold text-vmhs-blue mb-1">Question ${currentQIdx + 1} of ${exam.questions.length}</p>
                            <h3 class="text-xl font-bold text-gray-800 leading-tight">${q.q}</h3>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-1 gap-3">
                    ${q.options.map((opt, i) => {
                        const letters = ['A', 'B', 'C', 'D'];
                        const letter = letters[i];
                        return `
                        <div class="opt-row-audio">
                            ${isAudioLevel ? `<button class="speak-btn" onclick="playFile('audio/G${activeGrade}Q${currentQIdx + 1}${letter}.mp3')">ðŸ”Š</button>` : ''}
                            <button class="option-card flex-1 p-4 rounded-xl text-left font-medium bg-white ${currentAnswers[currentQIdx] === i ? 'selected' : ''}" onclick="handleChoice(${i})">
                                ${opt}
                            </button>
                        </div>`;
                    }).join('')}
                </div>
            </div>`;
        
        document.getElementById('quiz-area').innerHTML = quizHtml;
        const nextBtn = document.getElementById('next-btn');
        document.getElementById('prev-btn').style.visibility = currentQIdx === 0 ? 'hidden' : 'visible';
        
        if (currentQIdx === exam.questions.length - 1) {
            nextBtn.innerText = "Submit Assessment";
            nextBtn.disabled = currentAnswers.some(a => a === null);
        } else {
            nextBtn.innerText = "Next Question";
            nextBtn.disabled = false;
        }
        updateNavStyles();
    }

    function handleChoice(idx) { currentAudio.pause(); currentAnswers[currentQIdx] = idx; loadQuestion(); }
    function jumpToQuestion(i) { currentAudio.pause(); currentQIdx = i; loadQuestion(); }
    function prevQuestion() { if(currentQIdx > 0) { currentAudio.pause(); currentQIdx--; loadQuestion(); } }

    function handleNext() {
        const exam = examData[activeGrade];
        if(currentQIdx < exam.questions.length - 1) { currentQIdx++; loadQuestion(); } 
        else {
            currentScore = 0;
            exam.questions.forEach((q, i) => { if(currentAnswers[i] === q.correct) currentScore++; });
            processResults();
        }
    }

    function processResults() {
        const total = examData[activeGrade].questions.length;
        const pct = (currentScore / total);
        let profile = (pct >= 0.8) ? "Independent" : (pct >= 0.59) ? "Instructional" : "Frustration";
        sessionResults.push({ grade: activeGrade, score: `${currentScore}/${total}`, profile: profile });
        
        // Dynamic pathing based on Phil-IRI rules
        if (sessionResults.length === 1) {
            if (profile === "Frustration") { 
                [activeGrade-3, activeGrade-2, activeGrade-1].forEach(g => { if(g >= 4) queue.push(g); }); 
            }
            else if (profile === "Instructional") { 
                if(activeGrade-1 >= 4) queue.push(activeGrade-1); 
                if(activeGrade+1 <= 10) queue.push(activeGrade+1); 
            }
            else { 
                if(activeGrade+1 <= 10) queue.push(activeGrade+1); 
                if(activeGrade+2 <= 10) queue.push(activeGrade+2); 
            }
            totalTestsInSequence = 1 + queue.length;
        }
        
        if (queue.length > 0) { 
            showTransition(queue.shift()); 
        } else { 
            showFinalReport(); 
        }
    }

    function showTransition(nextG) {
        document.getElementById('test-step').classList.add('hidden');
        document.getElementById('transition-step').classList.remove('hidden');
        document.getElementById('transition-msg').innerText = `Preparing Grade ${nextG} passage...`;
        setTimeout(() => runGradeSequence(nextG), 2000);
    }

    function showFinalReport() {
        document.getElementById('test-step').classList.add('hidden');
        document.getElementById('results-step').classList.remove('hidden');
        let html = "";
        
        // Prep payload for Google Sheets
        finalPayload = { 
            lrn: document.getElementById('lrn').value, 
            surname: document.getElementById('surname').value, 
            firstName: document.getElementById('firstName').value, 
            mi: document.getElementById('mi').value, 
            enrollmentGrade: document.getElementById('studentGrade').value, 
            section: document.getElementById('section').value, 
            timestamp: new Date().toLocaleString() 
        };
        
        // Initialize grade slots to empty
        for(let i=4; i<=10; i++) finalPayload['g' + i] = "";

        sessionResults.forEach(r => {
            const color = r.profile === "Independent" ? "text-green-600 bg-green-50" : r.profile === "Instructional" ? "text-blue-600 bg-blue-50" : "text-red-600 bg-red-50";
            html += `<div class="p-6 bg-white border-2 border-gray-100 rounded-3xl shadow-sm text-center mb-4">
                        <p class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">Grade ${r.grade} Level</p>
                        <div class="text-3xl font-black mb-1">${r.score}</div>
                        <div class="inline-block px-4 py-1 rounded-full text-sm font-bold uppercase ${color}">${r.profile}</div>
                    </div>`;
            finalPayload['g' + r.grade] = r.profile;
        });
        document.getElementById('cumulative-results').innerHTML = html;
    }

    async function sendToDatabase() {
        const btn = document.getElementById('db-btn');
        btn.disabled = true; btn.innerText = "SUBMITTING...";
        
        const formData = new URLSearchParams();
        for (let key in finalPayload) formData.append(key, finalPayload[key]);
        
        try {
            // mode 'no-cors' is used to prevent CORS errors with Google Apps Script
            await fetch(FINAL_GS_LINK, { 
                method: 'POST', 
                mode: 'no-cors', 
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: formData.toString() 
            });
            
            btn.innerText = "SUCCESSFULLY SENT!";
            btn.classList.replace('btn-primary', 'bg-green-600');
            setTimeout(() => location.reload(), 3000);
        } catch (e) { 
            console.error(e);
            btn.disabled = false; 
            btn.innerText = "RETRY SUBMISSION"; 
        }
    }

    function updateStepCounter() { 
        document.getElementById('step-indicator').innerText = `Assessment ${sessionResults.length + 1} of ${totalTestsInSequence}`; 
    }
</script>
</body>
</html>

